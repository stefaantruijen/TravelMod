package com.tvdp.travelmod.advancements;

import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.util.List;
import java.util.Map;

import com.google.common.collect.Lists;
import com.google.common.collect.Maps;
import com.tvdp.travelmod.Main;
import com.tvdp.travelmod.util.Reference;

import net.minecraft.advancements.CriteriaTriggers;
import net.minecraft.advancements.ICriterionTrigger;
import net.minecraft.util.ResourceLocation;
import net.minecraftforge.fml.relauncher.ReflectionHelper;

public class Triggers
{
	private static final Map < ResourceLocation, ICriterionTrigger<? >> TRIGGERS = Maps. < ResourceLocation, ICriterionTrigger<? >> newHashMap();

    public static final TravelDimensionEnterTrigger TRAVEL_DIMENSION_ENTER_TRIGGER = (TravelDimensionEnterTrigger)Triggers.register(new TravelDimensionEnterTrigger());
    
    public static <T extends ICriterionTrigger> T register(T criterion)
    {
        if (TRIGGERS.containsKey(criterion.getId()))
        {
            throw new IllegalArgumentException("Duplicate criterion id " + criterion.getId());
        }
        else
        {
            TRIGGERS.put(criterion.getId(), criterion);
            return criterion;
        }
    }

    public static void init()
    {
        Method method;
        try
        {
            method = ReflectionHelper.findMethod(CriteriaTriggers.class, "register", "func_192118_a", ICriterionTrigger.class);
            method.setAccessible(true);
            for(int i = 0; i < TRIGGERS.size(); i++)
            {
                method.invoke(null, TRIGGERS.get(i));
            }
        }
        catch(SecurityException | IllegalAccessException | IllegalArgumentException | InvocationTargetException e)
        {
        	System.out.println("Failed to register trigger " + trigger.getId() + "!");
			e.printStackTrace();
        }
    }
}
